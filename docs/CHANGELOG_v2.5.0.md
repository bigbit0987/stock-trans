# AlphaHunter v2.5.0 架构重构与策略增强

**发布日期**: 2026-01-09
**版本号**: v2.5.0 (里程碑版本)

本次更新是 AlphaHunter 的一次重大迭代，从"单机脚本"向"专业量化系统"迈进。主要涉及底层存储引擎切换、风控逻辑解耦及核心选股因子的深度增强。

---

## 🏛️ 架构升级：从 JSON 到 SQLite

为了应对日益增长的数据复杂性，并彻底消除并发冲突风险，我们将持仓与交易记录迁移至 SQLite 数据库。

- **Transactionality**: 支持原子化更新。在盘中监控同时进行手动调仓时，不再有丢失数据的风险。
- **Consistency**: 实时同步盘中最高价至数据库，确保回撤判定在任何重启情况下都能保持连续性。
- **Modularity**: 将持仓逻辑集中于 `src/database.py`，实现上层逻辑与存储层的解耦。

## 🛡️ 等级化差异风控 (Grade-based Risk Management)

不再对所有股票一视同仁。根据股票的评级（Grade A/B/C），实施不同的风控动作。

- **Grade A (核心资产)**:
  - 给予更大的 ATR 止损波动空间 (1.5x ATR)。
  - 忍受更大幅度的浮盈回撤 (-5%)，以博取主升浪中的翻倍利润。
- **Grade B (普通潜力)**: 标准风控。
- **Grade C (稳健套利)**: 极度敏感。
  - 窄止损位。
  - 浮盈回撤 2.5% 即刻触发止盈保护。

## 🏹 策略内核：三大因子深度挖掘

### 1. RPS 长短周期背离滤网

识别"高位退潮"股。如果个股 RPS120 极高（说明过去半年很强）但 RPS20 骤降（说明近期动能枯竭），系统将标记为"🚫 强势股补跌风险"并拦截买入信号。

### 2. 尾盘量能吸筹分析

针对通过基础筛选的个股，并发拉取 1 分钟级高频成交数据。计算 14:45-15:00 的成交占比，若显著超过理论均值（15% 以上），则标注“✨ 尾盘吸筹”并大幅加分。

### 3. 全市场宽度探测

通过统计全市场创 20 日新高的个股数量，实时评估当前行情的赚钱效应。该指标已集成至 `market` 命令，为交易员执行加减仓提供宏观建议。

## 🔧 健壮性与易用性优化

- **Data Standardization**: 在 `data_loader.py` 中引入列名标准映射表，屏蔽 Akshare(数据源) 字段波动的风险。
- **CLI 增强**: `add` 命令增加 `--grade` 参数，支持手动录入评级。
- **可视化同步**: Dashboard 分支全面适配 SQLite 数据库，展示更实时、更精准的战绩统计。

---

### 下一步计划 (Roadmap v2.6.0)

1. **板块热度 2.0**: 结合细分行业 RPS 和概念板块共振的二级滤网。
2. **多进程并发优化**: 将 `scanner.py` 的并发粒度细化至全流程，彻底消除 GIL 影响。
3. **资金曲线可视化增强**: 加入回撤曲线分析及夏普比率等专业评价指标。
